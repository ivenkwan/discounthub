(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["x8128"],{8096:function(t,e,s){"use strict";s.r(e);var r=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{directives:[{name:"resize",rawName:"v-resize",value:t.onResize,expression:"onResize"}],staticClass:"viewContainer"},[s("v-container",{staticClass:"pa-0"},[s("v-img",{key:t.tabImg,attrs:{src:t.tabImg,"min-height":t.tabImgHeight,"aspect-ratio":t.tabImgAspectRation,transition:"fade-transition"}},[s("v-container",{staticClass:"inner-container"},[s("v-card",{staticClass:"mt-md-12 mt-0 content-tabs-wrapper",attrs:{tile:"",elevation:"0"}},[s("v-tabs",{staticClass:"px-5 content-tabs",attrs:{color:t.$store.state.app.dark?"white":"black","icons-and-text":"",height:"100","slider-size":"4","show-arrows":""}},[s("v-tabs-slider"),s("v-tab",{staticClass:"no-caps",attrs:{to:{name:"business.issue-points"},ripple:!1}},[t._v(" "+t._s(t.$t("issue"))+" "),s("v-icon",{attrs:{size:"24"}},[t._v("mdi-coins")])],1),s("v-tab",{staticClass:"no-caps",attrs:{to:{name:"business.redeem-points"},ripple:!1}},[t._v(" "+t._s(t.$t("redeem"))+" "),s("v-icon",{attrs:{size:"24"}},[t._v("mdi-wallet-giftcard")])],1),s("v-tab",{staticClass:"no-caps",attrs:{to:{name:"business.transactions"},ripple:!1}},[t._v(" "+t._s(t.$t("transactions"))+" "),s("v-icon",{attrs:{size:"24"}},[t._v("mdi-format-list-bulleted")])],1)],1),s("v-divider")],1),s("v-tabs-items",{staticStyle:{"background-color":"transparent"},model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[s("v-tab-item",{attrs:{value:"tab-0"}},[s("v-container",{staticClass:"pa-0"},[s("v-row",{attrs:{"no-gutters":""}},[s("v-col",{attrs:{cols:"12",sm:"9",md:"6"}},[s("v-card",{staticClass:"content-tabs-card pa-5 mb-0 mb-md-12",attrs:{flat:"",tile:""}},[4!==t.$auth.user().role||t.$auth.user().premium?s("v-card-text",[s("v-alert",{staticClass:"mb-5",attrs:{value:t.issuePointsForm.success,type:"success"}},[s("i18n",{attrs:{path:"issue_points_success"},scopedSlots:t._u([{key:"customerNumber",fn:function(){return[t._v(" "+t._s(t.msg.customerNumber)+" ")]},proxy:!0},{key:"points",fn:function(){return[t._v(" "+t._s(t.msg.points)+" ")]},proxy:!0},{key:"value",fn:function(){return[t._v(" "+t._s(t.msg.value)+" ")]},proxy:!0},{key:"transactions",fn:function(){return[s("router-link",{staticClass:"white--text",attrs:{to:{name:"business.transactions"}}},[t._v(t._s(t.$t("transactions").toLowerCase()))])]},proxy:!0}])})],1),3===t.$auth.user().role?s("p",{staticClass:"fg--text subtitle-1 font-weight-medium"},[s("i18n",{attrs:{path:"issue_points_configure_rules"},scopedSlots:t._u([{key:"configure_the_rules",fn:function(){return[s("router-link",{attrs:{to:{name:"business.rules"}}},[t._v(t._s(t.$t("configure_the_rules").toLowerCase()))])]},proxy:!0}],null,!1,2093517226)})],1):t._e(),s("p",{staticClass:"fg--text subtitle-1"},[t._v(t._s(t.$t("issue_points_head")))]),s("ValidationObserver",{ref:"verifyCustomerNumberForm",scopedSlots:t._u([{key:"default",fn:function(e){var r=e.invalid;return[s("v-form",{attrs:{id:"verifyCustomerNumberForm","lazy-validation":"",autocomplete:"off",method:"post","accept-charset":"UTF-8"},on:{submit:function(e){return e.preventDefault(),t.verifyCustomerNumber()}}},[s("v-row",{attrs:{"no-gutters":""}},[s("v-col",{attrs:{cols:"8"}},[s("qrcode-capture",{staticClass:"d-none",attrs:{multiple:!1,id:"qrScanner",tabindex:"-1"},on:{detect:t.onDetect}}),s("x-text-field",{directives:[{name:"mask",rawName:"v-mask",value:"###-###-###-###",expression:"'###-###-###-###'"}],ref:"verifyCustomerNumberForm.customerNumber",staticClass:"title qrcode-button",attrs:{inputmode:"numeric",name:t.$t("customer_number"),id:"verifyCustomerNumberForm.customerNumber",rules:"required|min:15|max:15",outlined:"",placeholder:"###-###-###-###","prepend-inner-icon":t.supportsQrCamera()?"mdi-qrcode":"",loading:t.inputLoading},on:{"click:prepend-inner":t.openQrCamera},model:{value:t.verifyCustomerNumberForm.customerNumber,callback:function(e){t.$set(t.verifyCustomerNumberForm,"customerNumber",e)},expression:"verifyCustomerNumberForm.customerNumber"}})],1),s("v-col",{attrs:{cols:"4"}},[s("v-btn",{staticClass:"title ma-0 no-caps",attrs:{type:"submit",depressed:"",tile:"",block:"",color:"ctaBg ctaFg--text",height:"56px",loading:t.verifyCustomerNumberForm.loading,disabled:t.verifyCustomerNumberForm.loading||r}},[t._v(" "+t._s(t.$t("verify"))+" "),s("v-icon",{attrs:{right:""}},[t._v("mdi-arrow-right")])],1)],1)],1)],1)]}}])}),t.supportsQrCamera()?s("p",{staticClass:"mt-0 mb-0 fg--text subtitle-1"},[t._v(t._s(t.$t("issue_points_footer_qr")))]):t._e(),t.supportsQrCamera()?t._e():s("p",{staticClass:"mt-0 mb-0 fg--text subtitle-1"},[t._v(t._s(t.$t("issue_points_footer")))])],1):s("v-card-text",[s("p",{staticClass:"fg--text subtitle-1 font-weight-medium"},[t._v(" "+t._s(t.$t("account_inactive"))+" ")])])],1)],1)],1)],1)],1)],1)],1)],1)],1),s("v-dialog",{attrs:{persistent:"","max-width":"320"},model:{value:t.dialogIssuePoints,callback:function(e){t.dialogIssuePoints=e},expression:"dialogIssuePoints"}},[s("ValidationObserver",{ref:"issuePointsForm",scopedSlots:t._u([{key:"default",fn:function(e){var r=e.invalid;return[s("v-form",{attrs:{id:"issuePointsForm","lazy-validation":"",autocomplete:"off",method:"post"},on:{submit:function(e){return e.preventDefault(),t.issuePoints()}}},[s("v-card",[s("v-card-title",{staticClass:"headline"},[t._v(t._s(t.$t("issue_points")))]),s("v-card-text",[s("p",{staticClass:"body-1"},[t._v(t._s(t.$t("enter_amount_of_purchase")))]),s("x-text-field",{ref:"issuePointsForm.amount",attrs:{type:"number",autofocus:"",id:"issuePointsForm.amount",name:t.$t("amount"),suffix:t.business.currency,step:t.business.currency_step,rules:"required|between:1,100000",hint:t.purchaseAmount+" = "+t.pointsIssued+" "+t.$t("points").toLowerCase(),"persistent-hint":""},model:{value:t.issuePointsForm.amount,callback:function(e){t.$set(t.issuePointsForm,"amount",e)},expression:"issuePointsForm.amount"}})],1),s("v-card-actions",[s("v-spacer"),s("v-btn",{staticClass:"no-caps",attrs:{color:"secondary",text:""},on:{click:function(e){t.dialogIssuePoints=!1}}},[t._v(t._s(t.$t("close")))]),s("v-btn",{staticClass:"no-caps",attrs:{color:"NavBg NavFg--text",depressed:"",loading:t.issuePointsForm.loading,disabled:t.issuePointsForm.loading||r,type:"submit"}},[t._v(t._s(t.$t("issue_points")))])],1)],1)],1)]}}])})],1)],1)},i=[],a=s("a34a"),n=s.n(a),o=s("2fa3"),u=s("9a3e"),c=s("3a60");function m(t,e,s,r,i,a,n){try{var o=t[a](n),u=o.value}catch(c){return void s(c)}o.done?e(u):Promise.resolve(u).then(r,i)}function l(t){return function(){var e=this,s=arguments;return new Promise((function(r,i){var a=t.apply(e,s);function n(t){m(a,r,i,n,o,"next",t)}function o(t){m(a,r,i,n,o,"throw",t)}n(void 0)}))}}var p={components:{QrcodeCapture:u["QrcodeCapture"]},data:function(){return{dialogIssuePoints:!1,locale:"en",tab:"tab-0",tabImg:"about:blank",tabImgHeight:null,tabImgDefaultHeight:780,tabImgAspectRation:1.7778,tabImgs:[],inputLoading:!1,msg:{points:0,value:0,customerNumber:""},verifyCustomerNumberForm:{loading:!1,customerNumber:""},issuePointsForm:{loading:!1,success:!1,amount:""},business:{currency:"USD",currency_step:.01,points_per_currency:null,point_value:null,points_expiration_months:null,min_points_per_purchase:null,max_points_per_purchase:null,min_points_per_redemption:null,max_points_per_redemption:null}}},directives:{mask:c["mask"]},created:function(){var t=this;this.locale=this.$auth.check()?this.$auth.user().locale:Intl.DateTimeFormat().resolvedOptions().locale||this.$i18n.locale,this.moment.locale(this.locale.substr(0,2)),this.tabImgs=[this.$init.config.schemeAndHost+"/img/business-issue-tab.jpg"],window.innerWidth>760?(this.tabImg=this.tabImgs[0],this.tabImgHeight=this.tabImgDefaultHeight,this.tabImgAspectRation=1.7778):(this.tabImgHeight=null,this.tabImgAspectRation=3);var e=new Array;this.tabImgs.forEach((function(t,s){e[s]=new Image,e[s].src=t})),this.verifyCustomerNumberForm.customerNumber=this.$route.query.c,this.axios.get("/business/settings",{params:{locale:this.$i18n.locale}}).then((function(e){var s=e.data.business;t.business.currency=s.currency,t.business.currency_step=s.currency_step,t.business.points_per_currency=s.points_per_currency,t.business.point_value=s.point_value,t.business.points_expiration_months=s.points_expiration_months,t.business.min_points_per_purchase=s.min_points_per_purchase,t.business.max_points_per_purchase=s.max_points_per_purchase,t.business.min_points_per_redemption=s.min_points_per_redemption,t.business.max_points_per_redemption=s.max_points_per_redemption}))},methods:{supportsQrCamera:o["c"],formatNumber:function(t){return new Intl.NumberFormat(this.locale.replace("_","-")).format(t)},formatCurrency:function(t){return new Intl.NumberFormat(this.locale.replace("_","-"),{style:"currency",currency:this.business.currency}).format(t)},openQrCamera:function(){this.$el.querySelector("#qrScanner").click()},onDetect:function(t){var e=this;return l(n.a.mark((function s(){var r,i,a,o;return n.a.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return e.$refs["verifyCustomerNumberForm"].reset(),e.inputLoading=!0,s.prev=2,s.next=5,t;case 5:r=s.sent,r.imageData,i=r.content,r.location,null===i?e.$refs["verifyCustomerNumberForm.customerNumber"].applyResult({errors:e.$t("camera_no_qr_found"),valid:!1,failedRules:{}}):(a=new window.URL(i),o=new window.URLSearchParams(a.search),e.verifyCustomerNumberForm.customerNumber=o.get("c")),s.next=15;break;case 12:s.prev=12,s.t0=s["catch"](2),e.$refs["verifyCustomerNumberForm.customerNumber"].applyResult({errors:s.t0,valid:!1,failedRules:{}});case 15:return s.prev=15,e.inputLoading=!1,s.finish(15);case 18:case"end":return s.stop()}}),s,null,[[2,12,15,18]])})))()},verifyCustomerNumber:function(){var t=this;this.verifyCustomerNumberForm.loading=!0,this.axios.post("/business/issue/verify-customer-number",{locale:this.locale,customerNumber:this.verifyCustomerNumberForm.customerNumber}).then((function(e){"success"===e.data.status&&(t.$nextTick((function(){return t.$refs["verifyCustomerNumberForm"].reset()})),t.dialogIssuePoints=!0)})).catch((function(e){if("error"===e.response.data.status){t.errorMsg=e.response.data.error;var s=e.response.data.errors||[];for(var r in s)t.$refs["verifyCustomerNumberForm."+r].applyResult({errors:s[r],valid:!1,failedRules:{}})}})).finally((function(){t.verifyCustomerNumberForm.loading=!1}))},issuePoints:function(){var t=this;this.issuePointsForm.loading=!0,this.axios.post("/business/issue/amount",{locale:this.locale,customerNumber:this.verifyCustomerNumberForm.customerNumber,amount:this.issuePointsForm.amount}).then((function(e){"success"===e.data.status&&(t.$nextTick((function(){return t.$refs["issuePointsForm"].reset()})),t.dialogIssuePoints=!1,t.issuePointsForm.success=!0,t.verifyCustomerNumberForm.customerNumber="",t.issuePointsForm.amount="",t.msg.points=t.formatNumber(e.data.points),t.msg.value=t.formatCurrency(e.data.value),t.msg.customerNumber=e.data.customer_number)})).catch((function(e){if("error"===e.response.data.status){t.errorMsg=e.response.data.error;var s=e.response.data.errors||[];for(var r in s)t.$refs["issuePointsForm."+r].applyResult({errors:s[r],valid:!1,failedRules:{}})}})).finally((function(){t.issuePointsForm.loading=!1}))},onResize:function(){if(window.innerWidth<=760)this.tabImg="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=",this.tabImgHeight=null,this.tabImgAspectRation=3;else if("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII="==this.tabImg){var t=this.tab.split("-");this.tabImg=this.tabImgs[t[1]],this.tabImgHeight=this.tabImgDefaultHeight,this.tabImgAspectRation=1.7778}}},computed:{purchaseAmount:function(){return this.formatCurrency(this.issuePointsForm.amount)},pointsIssued:function(){var t=this.business.points_per_currency*this.issuePointsForm.amount;return parseInt(t)<parseInt(this.business.min_points_per_purchase)&&(t=this.business.min_points_per_purchase),parseInt(t)>parseInt(this.business.max_points_per_purchase)&&(t=this.business.max_points_per_purchase),this.formatNumber(t)}}},d=p,b=s("2877"),f=s("6544"),v=s.n(f),_=s("0798"),h=s("8336"),g=s("b0af"),C=s("99d9"),y=s("62ad"),A=s("a523"),x=s("169a"),N=s("ce7e"),I=s("4bd4"),w=s("132d"),F=s("adda"),$=s("0fd9"),k=s("2fa4"),P=s("71a3"),V=s("c671"),R=s("fe57"),S=s("aac8"),z=s("9a96"),D=s("269a"),H=s.n(D),Q=s("dc22"),q=Object(b["a"])(d,r,i,!1,null,null,null);e["default"]=q.exports;v()(q,{VAlert:_["a"],VBtn:h["a"],VCard:g["a"],VCardActions:C["a"],VCardText:C["b"],VCardTitle:C["c"],VCol:y["a"],VContainer:A["a"],VDialog:x["a"],VDivider:N["a"],VForm:I["a"],VIcon:w["a"],VImg:F["a"],VRow:$["a"],VSpacer:k["a"],VTab:P["a"],VTabItem:V["a"],VTabs:R["a"],VTabsItems:S["a"],VTabsSlider:z["a"]}),H()(q,{Resize:Q["a"]})}}]);
//# sourceMappingURL=x8128.745b3c3c.js.map