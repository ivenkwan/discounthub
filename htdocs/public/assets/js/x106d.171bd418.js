(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["x106d"],{d9f77:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"resize",rawName:"v-resize",value:e.onResize,expression:"onResize"}],staticClass:"viewContainer"},[a("v-container",{staticClass:"pa-0"},[a("v-img",{key:e.tabImg,attrs:{src:e.tabImg,"min-height":e.tabImgHeight,"aspect-ratio":e.tabImgAspectRation,transition:"fade-transition"}},[a("v-container",{staticClass:"inner-container"},[a("v-card",{staticClass:"mt-md-12 mt-0 content-tabs-wrapper",attrs:{tile:"",elevation:"0"}},[a("v-tabs",{staticClass:"px-5 content-tabs",attrs:{color:e.$store.state.app.dark?"white":"black","icons-and-text":"",height:"100","slider-size":"4","show-arrows":""}},[a("v-tabs-slider"),a("v-tab",{staticClass:"no-caps",attrs:{to:{name:"business.issue-points"},ripple:!1}},[e._v(" "+e._s(e.$t("issue"))+" "),a("v-icon",{attrs:{size:"24"}},[e._v("mdi-coins")])],1),a("v-tab",{staticClass:"no-caps",attrs:{to:{name:"business.redeem-points"},ripple:!1}},[e._v(" "+e._s(e.$t("redeem"))+" "),a("v-icon",{attrs:{size:"24"}},[e._v("mdi-wallet-giftcard")])],1),a("v-tab",{staticClass:"no-caps",attrs:{to:{name:"business.transactions"},ripple:!1}},[e._v(" "+e._s(e.$t("transactions"))+" "),a("v-icon",{attrs:{size:"24"}},[e._v("mdi-format-list-bulleted")])],1)],1),a("v-divider")],1),a("v-tabs-items",{staticStyle:{"background-color":"transparent"},model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[a("v-tab-item",{attrs:{value:"tab-0"}},[a("v-container",{staticClass:"pa-0"},[a("v-row",{attrs:{"no-gutters":""}},[a("v-col",{attrs:{cols:"12",sm:"9",md:"6"}},[a("v-card",{staticClass:"content-tabs-card pa-5 mb-0 mb-md-12",attrs:{flat:"",tile:""}},[4!==e.$auth.user().role||e.$auth.user().premium?a("v-card-text",[a("v-alert",{staticClass:"mb-5",attrs:{value:e.verifyCodeForm.success,type:"success"}},[a("i18n",{attrs:{path:"redeem_points_success"},scopedSlots:e._u([{key:"points",fn:function(){return[e._v(" "+e._s(e.msg.points)+" ")]},proxy:!0},{key:"value",fn:function(){return[e._v(" "+e._s(e.msg.value)+" ")]},proxy:!0},{key:"customerNumber",fn:function(){return[e._v(" "+e._s(e.msg.customerNumber)+" ")]},proxy:!0},{key:"transactions",fn:function(){return[a("router-link",{staticClass:"white--text",attrs:{to:{name:"business.transactions"}}},[e._v(e._s(e.$t("transactions").toLowerCase()))])]},proxy:!0}])})],1),a("p",{staticClass:"fg--text subtitle-1"},[e._v(e._s(e.$t("redeem_points_head")))]),a("ValidationObserver",{ref:"verifyCodeForm",scopedSlots:e._u([{key:"default",fn:function(t){var s=t.invalid;return[a("v-form",{attrs:{id:"verifyCodeForm","lazy-validation":"",autocomplete:"off",method:"post","accept-charset":"UTF-8"},on:{submit:function(t){return t.preventDefault(),e.verifyCode()}}},[a("v-row",{attrs:{"no-gutters":""}},[a("v-col",{attrs:{cols:"8"}},[a("qrcode-capture",{staticClass:"d-none",attrs:{multiple:!1,id:"qrScanner",tabindex:"-1"},on:{detect:e.onDetect}}),a("x-text-field",{directives:[{name:"mask",rawName:"v-mask",value:"####",expression:"'####'"}],ref:"verifyCodeForm.code",staticClass:"title",attrs:{inputmode:"numeric",name:e.$t("code"),id:"verifyCodeForm.code",rules:"required|min:4|max:4",outlined:"",placeholder:"####","prepend-inner-icon":e.supportsQrCamera()?"mdi-qrcode":"",loading:e.inputLoading},on:{"click:prepend-inner":e.openQrCamera},model:{value:e.verifyCodeForm.code,callback:function(t){e.$set(e.verifyCodeForm,"code",t)},expression:"verifyCodeForm.code"}})],1),a("v-col",{attrs:{cols:"4"}},[a("v-btn",{staticClass:"title ma-0 no-caps",attrs:{type:"submit",depressed:"",tile:"",block:"",color:"ctaBg ctaFg--text",height:"56px",loading:e.verifyCodeForm.loading,disabled:e.verifyCodeForm.loading||s}},[e._v(" "+e._s(e.$t("verify"))+" "),a("v-icon",{attrs:{right:""}},[e._v("mdi-arrow-right")])],1)],1)],1)],1)]}}])}),e.supportsQrCamera()?a("p",{staticClass:"mt-0 mb-0 fg--text subtitle-1"},[e._v(e._s(e.$t("redeem_points_footer_qr")))]):e._e(),e.supportsQrCamera()?e._e():a("p",{staticClass:"mt-0 mb-0 fg--text subtitle-1"},[e._v(e._s(e.$t("redeem_points_footer")))])],1):a("v-card-text",[a("p",{staticClass:"fg--text subtitle-1 font-weight-medium"},[e._v(" "+e._s(e.$t("account_inactive"))+" ")])])],1)],1)],1)],1)],1)],1)],1)],1)],1),a("v-dialog",{attrs:{persistent:"","max-width":"360"},model:{value:e.verifyCodeDialog,callback:function(t){e.verifyCodeDialog=t},expression:"verifyCodeDialog"}},[a("v-card",[a("v-card-title",{staticClass:"headline"},[e._v(e._s(e.$t("redeem_points")))]),a("v-card-text",[a("p",{staticClass:"body-1"},[a("i18n",{attrs:{path:"redeem_points_verify"},scopedSlots:e._u([{key:"points",fn:function(){return[e._v(" "+e._s(e.msg.points)+" ")]},proxy:!0},{key:"value",fn:function(){return[e._v(" "+e._s(e.msg.value)+" ")]},proxy:!0},{key:"customerNumber",fn:function(){return[e._v(" "+e._s(e.msg.customerNumber)+" ")]},proxy:!0}])})],1)]),a("v-card-actions",[a("v-spacer"),a("v-btn",{staticClass:"no-caps",attrs:{color:"secondary",text:""},on:{click:function(t){e.verifyCodeDialog=!1}}},[e._v(e._s(e.$t("cancel")))]),a("v-btn",{staticClass:"no-caps",attrs:{color:"NavBg NavFg--text",depressed:"",loading:e.verifyCodeForm.loading,disabled:e.verifyCodeForm.loading},on:{click:function(t){e.verifyCodeDialog=!1,e.processCode()}}},[e._v(e._s(e.$t("redeem_points")))])],1)],1)],1)],1)},r=[],o=a("a34a"),i=a.n(o),n=a("2fa3"),c=a("9a3e"),l=a("3a60");function d(e,t,a,s,r,o,i){try{var n=e[o](i),c=n.value}catch(l){return void a(l)}n.done?t(c):Promise.resolve(c).then(s,r)}function m(e){return function(){var t=this,a=arguments;return new Promise((function(s,r){var o=e.apply(t,a);function i(e){d(o,s,r,i,n,"next",e)}function n(e){d(o,s,r,i,n,"throw",e)}i(void 0)}))}}var u={components:{QrcodeCapture:c["QrcodeCapture"]},data:function(){return{locale:"en",verifyCodeDialog:!1,tab:"tab-0",tabImg:"about:blank",tabImgHeight:null,tabImgDefaultHeight:780,tabImgAspectRation:1.7778,tabImgs:[],inputLoading:!1,verifyCodeForm:{success:!1,loading:!1,code:""},msg:{points:0,value:0,customerNumber:""}}},directives:{mask:l["mask"]},created:function(){this.locale=this.$auth.check()?this.$auth.user().locale:Intl.DateTimeFormat().resolvedOptions().locale||this.$i18n.locale,this.moment.locale(this.locale.substr(0,2)),this.tabImgs=[this.$init.config.schemeAndHost+"/img/business-redeem-tab.jpg"],window.innerWidth>760?(this.tabImg=this.tabImgs[0],this.tabImgHeight=this.tabImgDefaultHeight,this.tabImgAspectRation=1.7778):(this.tabImgHeight=null,this.tabImgAspectRation=3);var e=new Array;this.tabImgs.forEach((function(t,a){e[a]=new Image,e[a].src=t})),this.verifyCodeForm.code=this.$route.query.c},methods:{supportsQrCamera:n["c"],copyStringToClipboard:n["a"],formatNumber:function(e){return new Intl.NumberFormat(this.locale.replace("_","-")).format(e)},formatCurrency:function(e,t){return new Intl.NumberFormat(this.locale.replace("_","-"),{style:"currency",currency:t}).format(e)},onResize:function(){if(window.innerWidth<=760)this.tabImg="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=",this.tabImgHeight=null,this.tabImgAspectRation=3;else if("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII="==this.tabImg){var e=this.tab.split("-");this.tabImg=this.tabImgs[e[1]],this.tabImgHeight=this.tabImgDefaultHeight,this.tabImgAspectRation=1.7778}},openQrCamera:function(){this.$el.querySelector("#qrScanner").click()},onDetect:function(e){var t=this;return m(i.a.mark((function a(){var s,r,o,n;return i.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.$refs["verifyCodeForm"].reset(),t.inputLoading=!0,a.prev=2,a.next=5,e;case 5:s=a.sent,s.imageData,r=s.content,s.location,null===r?t.$refs["verifyCodeForm.code"].applyResult({errors:t.$t("camera_no_qr_found"),valid:!1,failedRules:{}}):(o=new window.URL(r),n=new window.URLSearchParams(o.search),t.verifyCodeForm.code=n.get("c")),a.next=15;break;case 12:a.prev=12,a.t0=a["catch"](2),t.$refs["verifyCodeForm.code"].applyResult({errors:a.t0,valid:!1,failedRules:{}});case 15:return a.prev=15,t.inputLoading=!1,a.finish(15);case 18:case"end":return a.stop()}}),a,null,[[2,12,15,18]])})))()},verifyCode:function(){var e=this;this.verifyCodeForm.loading=!0,this.axios.post("/business/redeem/verify-code",{locale:this.locale,code:this.verifyCodeForm.code}).then((function(t){"success"===t.data.status&&(e.verifyCodeDialog=!0,e.msg.points=e.formatNumber(t.data.points),e.msg.value=e.formatCurrency(t.data.value,t.data.currency),e.msg.customerNumber=t.data.customer_number)})).catch((function(t){if("error"===t.response.data.status){e.errorMsg=t.response.data.error;var a=t.response.data.errors||[];for(var s in a)e.$refs["verifyCodeForm."+s].applyResult({errors:a[s],valid:!1,failedRules:{}})}})).finally((function(){window.scrollTo(0,0),e.verifyCodeForm.loading=!1}))},processCode:function(){var e=this;this.verifyCodeForm.loading=!0,this.axios.post("/business/redeem/process-code",{locale:this.locale,code:this.verifyCodeForm.code}).then((function(t){"success"===t.data.status&&(e.verifyCodeForm.code="",e.$nextTick((function(){return e.$refs["verifyCodeForm"].reset()})),e.verifyCodeForm.success=!0,e.msg.points=e.formatNumber(t.data.redeem.points),e.msg.value=e.formatCurrency(t.data.redeem.value,t.data.redeem.currency),e.msg.customerNumber=t.data.redeem.customer_number)})).catch((function(t){if("error"===t.response.data.status){e.errorMsg=t.response.data.error;var a=t.response.data.errors||[];for(var s in a)e.$refs["verifyCodeForm."+s].applyResult({errors:a[s],valid:!1,failedRules:{}})}})).finally((function(){window.scrollTo(0,0),e.verifyCodeForm.loading=!1}))}}},v=u,f=a("2877"),p=a("6544"),g=a.n(p),b=a("0798"),h=a("8336"),C=a("b0af"),y=a("99d9"),A=a("62ad"),_=a("a523"),w=a("169a"),x=a("ce7e"),I=a("4bd4"),F=a("132d"),k=a("adda"),$=a("0fd9"),R=a("2fa4"),V=a("71a3"),N=a("c671"),D=a("fe57"),S=a("aac8"),T=a("9a96"),H=a("269a"),Q=a.n(H),z=a("dc22"),q=Object(f["a"])(v,s,r,!1,null,null,null);t["default"]=q.exports;g()(q,{VAlert:b["a"],VBtn:h["a"],VCard:C["a"],VCardActions:y["a"],VCardText:y["b"],VCardTitle:y["c"],VCol:A["a"],VContainer:_["a"],VDialog:w["a"],VDivider:x["a"],VForm:I["a"],VIcon:F["a"],VImg:k["a"],VRow:$["a"],VSpacer:R["a"],VTab:V["a"],VTabItem:N["a"],VTabs:D["a"],VTabsItems:S["a"],VTabsSlider:T["a"]}),Q()(q,{Resize:z["a"]})}}]);
//# sourceMappingURL=x106d.171bd418.js.map